(function(r,n){'object'==typeof exports&&'object'==typeof module?module.exports=n():'function'==typeof define&&define.amd?define('WaveSurfer',[],n):'object'==typeof exports?exports.WaveSurfer=n():r.WaveSurfer=n()})(this,function(){return function(t){function r(s){if(n[s])return n[s].exports;var l=n[s]={i:s,l:!1,exports:{}};return t[s].call(l.exports,l,l.exports,r),l.l=!0,l.exports}var n={};return r.m=t,r.c=n,r.i=function(s){return s},r.d=function(s,l,o){r.o(s,l)||Object.defineProperty(s,l,{configurable:!1,enumerable:!0,get:o})},r.n=function(s){var l=s&&s.__esModule?function(){return s['default']}:function(){return s};return r.d(l,'a',l),l},r.o=function(s,l){return Object.prototype.hasOwnProperty.call(s,l)},r.p='localhost:8080/dist/',r(r.s=15)}([function(t,r,n){'use strict';function s(P){return P&&P.__esModule?P:{default:P}}Object.defineProperty(r,'__esModule',{value:!0});var l=n(8);Object.defineProperty(r,'ajax',{enumerable:!0,get:function(){return s(l).default}});var o=n(11);Object.defineProperty(r,'getId',{enumerable:!0,get:function(){return s(o).default}});var d=n(12);Object.defineProperty(r,'max',{enumerable:!0,get:function(){return s(d).default}});var u=n(13);Object.defineProperty(r,'min',{enumerable:!0,get:function(){return s(u).default}});var p=n(2);Object.defineProperty(r,'Observer',{enumerable:!0,get:function(){return s(p).default}});var f=n(9);Object.defineProperty(r,'extend',{enumerable:!0,get:function(){return s(f).default}});var v=n(14);Object.defineProperty(r,'style',{enumerable:!0,get:function(){return s(v).default}});var m=n(3);Object.defineProperty(r,'requestAnimationFrame',{enumerable:!0,get:function(){return s(m).default}});var k=n(10);Object.defineProperty(r,'frame',{enumerable:!0,get:function(){return s(k).default}});var g=n(16);Object.defineProperty(r,'debounce',{enumerable:!0,get:function(){return s(g).default}})},function(t,r,n){'use strict';function l(C,w,E){return w in C?Object.defineProperty(C,w,{value:E,enumerable:!0,configurable:!0,writable:!0}):C[w]=E,C}function o(C,w){if(!(C instanceof w))throw new TypeError('Cannot call a class as a function')}function d(C,w){if(!C)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return w&&('object'==typeof w||'function'==typeof w)?w:C}function u(C,w){if('function'!=typeof w&&null!==w)throw new TypeError('Super expression must either be null or a function, not '+typeof w);C.prototype=Object.create(w&&w.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(C,w):C.__proto__=w)}Object.defineProperty(r,'__esModule',{value:!0});var p=function(){function C(w,E){for(var R,_=0;_<E.length;_++)R=E[_],R.enumerable=R.enumerable||!1,R.configurable=!0,'value'in R&&(R.writable=!0),Object.defineProperty(w,R.key,R)}return function(w,E,_){return E&&C(w.prototype,E),_&&C(w,_),w}}(),f=n(0),v=function(C){if(C&&C.__esModule)return C;var w={};if(null!=C)for(var E in C)Object.prototype.hasOwnProperty.call(C,E)&&(w[E]=C[E]);return w.default=C,w}(f),m='playing',k='paused',g='finished',P=function(C){function w(E){var _,R;o(this,w);var A=d(this,(w.__proto__||Object.getPrototypeOf(w)).call(this));return A.audioContext=null,A.offlineAudioContext=null,A.stateBehaviors=(_={},l(_,m,{init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var S=this.getDuration();return this.getCurrentTime()/S||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}}),l(_,k,{init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var S=this.getDuration();return this.getCurrentTime()/S||0},getCurrentTime:function(){return this.startPosition}}),l(_,g,{init:function(){this.removeOnAudioProcess(),this.fireEvent('finish')},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}}),_),A.params=E,A.ac=E.audioContext||A.getAudioContext(),A.lastPlay=A.ac.currentTime,A.startPosition=0,A.scheduledPause=null,A.states=(R={},l(R,m,Object.create(A.stateBehaviors[m])),l(R,k,Object.create(A.stateBehaviors[k])),l(R,g,Object.create(A.stateBehaviors[g])),R),A.analyser=null,A.buffer=null,A.filters=[],A.gainNode=null,A.mergedPeaks=null,A.offlineAc=null,A.peaks=null,A.playbackRate=1,A.analyser=null,A.scriptNode=null,A.source=null,A.splitPeaks=[],A.state=null,A}return u(w,C),p(w,[{key:'supportsWebAudio',value:function(){return!!(window.AudioContext||window.webkitAudioContext)}},{key:'getAudioContext',value:function(){return window.WaveSurferAudioContext||(window.WaveSurferAudioContext=new(window.AudioContext||window.webkitAudioContext)),window.WaveSurferAudioContext}},{key:'getOfflineAudioContext',value:function(_){return window.WaveSurferOfflineAudioContext||(window.WaveSurferOfflineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,_)),window.WaveSurferOfflineAudioContext}}]),p(w,[{key:'init',value:function(){this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState(k),this.setPlaybackRate(this.params.audioRate),this.setLength(0)}},{key:'disconnectFilters',value:function(){this.filters&&(this.filters.forEach(function(_){_&&_.disconnect()}),this.filters=null,this.analyser.connect(this.gainNode))}},{key:'setState',value:function(_){this.state!==this.states[_]&&(this.state=this.states[_],this.state.init.call(this))}},{key:'setFilter',value:function(){for(var _=arguments.length,R=Array(_),A=0;A<_;A++)R[A]=arguments[A];this.setFilters(R)}},{key:'setFilters',value:function(_){this.disconnectFilters(),_&&_.length&&(this.filters=_,this.analyser.disconnect(),_.reduce(function(R,A){return R.connect(A),A},this.analyser).connect(this.gainNode))}},{key:'createScriptNode',value:function(){this.scriptNode=this.ac.createScriptProcessor?this.ac.createScriptProcessor(w.scriptBufferSize):this.ac.createJavaScriptNode(w.scriptBufferSize),this.scriptNode.connect(this.ac.destination)}},{key:'addOnAudioProcess',value:function(){var _=this;this.scriptNode.onaudioprocess=function(){var R=_.getCurrentTime();R>=_.getDuration()?(_.setState(g),_.fireEvent('pause')):R>=_.scheduledPause?_.pause():_.state===_.states[m]&&_.fireEvent('audioprocess',R)}}},{key:'removeOnAudioProcess',value:function(){this.scriptNode.onaudioprocess=null}},{key:'createAnalyserNode',value:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)}},{key:'createVolumeNode',value:function(){this.gainNode=this.ac.createGain?this.ac.createGain():this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)}},{key:'setVolume',value:function(_){this.gainNode.gain.value=_}},{key:'getVolume',value:function(){return this.gainNode.gain.value}},{key:'decodeArrayBuffer',value:function(_,R,A){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac?this.ac.sampleRate:44100)),this.offlineAc.decodeAudioData(_,function(W){return R(W)},A)}},{key:'setPeaks',value:function(_){this.peaks=_}},{key:'setLength',value:function(_){if(!(this.mergedPeaks&&_==2*this.mergedPeaks.length-1+2)){this.splitPeaks=[],this.mergedPeaks=[];var A,R=this.buffer?this.buffer.numberOfChannels:1;for(A=0;A<R;A++)this.splitPeaks[A]=[],this.splitPeaks[A][2*(_-1)]=0,this.splitPeaks[A][2*(_-1)+1]=0;this.mergedPeaks[2*(_-1)]=0,this.mergedPeaks[2*(_-1)+1]=0}}},{key:'getPeaks',value:function(_,R,A){if(this.peaks)return this.peaks;if(R=R||0,A=A||_-1,this.setLength(_),!this.buffer.length){var W=this.createBuffer(1,4096,this.sampleRate);this.buffer=W.buffer}var M,S=this.buffer.length/_,O=this.buffer.numberOfChannels;for(M=0;M<O;M++){var B=this.splitPeaks[M],L=this.buffer.getChannelData(M),D=void 0;for(D=R;D<=A;D++){var N=~~(D*S),I=0,z=0,V=void 0;for(V=N;V<~~(N+S);V+=~~(S/10)||1){var H=L[V];H>z&&(z=H),H<I&&(I=H)}B[2*D]=z,B[2*D+1]=I,(0==M||z>this.mergedPeaks[2*D])&&(this.mergedPeaks[2*D]=z),(0==M||I<this.mergedPeaks[2*D+1])&&(this.mergedPeaks[2*D+1]=I)}}return this.params.splitChannels?this.splitPeaks:this.mergedPeaks}},{key:'getPlayedPercents',value:function(){return this.state.getPlayedPercents.call(this)}},{key:'disconnectSource',value:function(){this.source&&this.source.disconnect()}},{key:'destroy',value:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode.disconnect(),this.analyser.disconnect(),this.params.closeAudioContext&&('function'==typeof this.ac.close&&'closed'!=this.ac.state&&this.ac.close(),this.ac=null,this.params.audioContext?this.params.audioContext=null:window.WaveSurferAudioContext=null,window.WaveSurferOfflineAudioContext=null)}},{key:'load',value:function(_){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=_,this.createSource()}},{key:'createSource',value:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.source.playbackRate.value=this.playbackRate,this.source.buffer=this.buffer,this.source.connect(this.analyser)}},{key:'isPaused',value:function(){return this.state!==this.states[m]}},{key:'getDuration',value:function(){return this.buffer?this.buffer.duration:0}},{key:'seekTo',value:function(_,R){if(this.buffer)return this.scheduledPause=null,null==_&&(_=this.getCurrentTime(),_>=this.getDuration()&&(_=0)),null==R&&(R=this.getDuration()),this.startPosition=_,this.lastPlay=this.ac.currentTime,this.state===this.states[g]&&this.setState(k),{start:_,end:R}}},{key:'getPlayedTime',value:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate}},{key:'play',value:function(_,R){if(this.buffer){this.createSource();var A=this.seekTo(_,R);_=A.start,R=A.end,this.scheduledPause=R,this.source.start(0,_,R-_),'suspended'==this.ac.state&&this.ac.resume&&this.ac.resume(),this.setState(m),this.fireEvent('play')}}},{key:'pause',value:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime(),this.source&&this.source.stop(0),this.setState(k),this.fireEvent('pause')}},{key:'getCurrentTime',value:function(){return this.state.getCurrentTime.call(this)}},{key:'getPlaybackRate',value:function(){return this.playbackRate}},{key:'setPlaybackRate',value:function(_){_=_||1,this.isPaused()?this.playbackRate=_:(this.pause(),this.playbackRate=_,this.play())}}]),w}(v.Observer);P.scriptBufferSize=256,r.default=P,t.exports=r['default']},function(t,r){'use strict';function s(d,u){if(!(d instanceof u))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(r,'__esModule',{value:!0});var l=function(){function d(u,p){for(var v,f=0;f<p.length;f++)v=p[f],v.enumerable=v.enumerable||!1,v.configurable=!0,'value'in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}return function(u,p,f){return p&&d(u.prototype,p),f&&d(u,f),u}}(),o=function(){function d(){s(this,d),this.handlers=null}return l(d,[{key:'on',value:function(p,f){var v=this;this.handlers||(this.handlers={});var m=this.handlers[p];return m||(m=this.handlers[p]=[]),m.push(f),{name:p,callback:f,un:function(g,P){return v.un(g,P)}}}},{key:'un',value:function(p,f){if(this.handlers){var m,v=this.handlers[p];if(v)if(f)for(m=v.length-1;0<=m;m--)v[m]==f&&v.splice(m,1);else v.length=0}}},{key:'unAll',value:function(){this.handlers=null}},{key:'once',value:function(p,f){var v=this;return this.on(p,function k(){for(var g=arguments.length,P=Array(g),C=0;C<g;C++)P[C]=arguments[C];f.apply(v,P),setTimeout(function(){v.un(p,k)},0)})}},{key:'fireEvent',value:function(p){for(var f=arguments.length,v=Array(1<f?f-1:0),m=1;m<f;m++)v[m-1]=arguments[m];if(this.handlers){var k=this.handlers[p];k&&k.forEach(function(g){g.apply(void 0,v)})}}}]),d}();r.default=o,t.exports=r['default']},function(t,r){'use strict';Object.defineProperty(r,'__esModule',{value:!0}),r.default=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(s){return setTimeout(s,1e3/60)}).bind(window),t.exports=r['default']},function(t,r,n){'use strict';function o(P,C){if(!(P instanceof C))throw new TypeError('Cannot call a class as a function')}function d(P,C){if(!P)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return C&&('object'==typeof C||'function'==typeof C)?C:P}function u(P,C){if('function'!=typeof C&&null!==C)throw new TypeError('Super expression must either be null or a function, not '+typeof C);P.prototype=Object.create(C&&C.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(P,C):P.__proto__=C)}Object.defineProperty(r,'__esModule',{value:!0});var p=function(){function P(C,w){for(var _,E=0;E<w.length;E++)_=w[E],_.enumerable=_.enumerable||!1,_.configurable=!0,'value'in _&&(_.writable=!0),Object.defineProperty(C,_.key,_)}return function(C,w,E){return w&&P(C.prototype,w),E&&P(C,E),C}}(),f=n(7),v=function(P){return P&&P.__esModule?P:{default:P}}(f),m=n(0),k=function(P){if(P&&P.__esModule)return P;var C={};if(null!=P)for(var w in P)Object.prototype.hasOwnProperty.call(P,w)&&(C[w]=P[w]);return C.default=P,C}(m),g=function(P){function C(w,E){o(this,C);var _=d(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,w,E));return _.maxCanvasWidth=E.maxCanvasWidth,_.maxCanvasElementWidth=Math.round(E.maxCanvasWidth/E.pixelRatio),_.hasProgressCanvas=E.waveColor!=E.progressColor,_.halfPixel=0.5/E.pixelRatio,_.canvases=[],_.progressWave=null,_}return u(C,P),p(C,[{key:'init',value:function(){this.createWrapper(),this.createElements()}},{key:'createElements',value:function(){this.progressWave=this.wrapper.appendChild(this.style(document.createElement('wave'),{position:'absolute',zIndex:3,left:0,top:0,bottom:0,overflow:'hidden',width:'0',display:'none',boxSizing:'border-box',borderRightStyle:'solid',borderRightWidth:this.params.cursorWidth+'px',borderRightColor:this.params.cursorColor,pointerEvents:'none'})),this.addCanvas()}},{key:'updateSize',value:function(){for(var E=this,_=Math.round(this.width/this.params.pixelRatio),R=Math.ceil(_/this.maxCanvasElementWidth);this.canvases.length<R;)this.addCanvas();for(;this.canvases.length>R;)this.removeCanvas();this.canvases.forEach(function(A,W){var S=E.maxCanvasWidth+2*Math.ceil(E.params.pixelRatio/2);W==E.canvases.length-1&&(S=E.width-E.maxCanvasWidth*(E.canvases.length-1)),E.updateDimensions(A,S,E.height),E.clearWaveForEntry(A)})}},{key:'addCanvas',value:function(){var E={},_=this.maxCanvasElementWidth*this.canvases.length;E.wave=this.wrapper.appendChild(this.style(document.createElement('canvas'),{position:'absolute',zIndex:2,left:_+'px',top:0,bottom:0,height:'100%',pointerEvents:'none'})),E.waveCtx=E.wave.getContext('2d'),this.hasProgressCanvas&&(E.progress=this.progressWave.appendChild(this.style(document.createElement('canvas'),{position:'absolute',left:_+'px',top:0,bottom:0,height:'100%'})),E.progressCtx=E.progress.getContext('2d')),this.canvases.push(E)}},{key:'removeCanvas',value:function(){var E=this.canvases.pop();E.wave.parentElement.removeChild(E.wave),this.hasProgressCanvas&&E.progress.parentElement.removeChild(E.progress)}},{key:'updateDimensions',value:function(E,_,R){var A=Math.round(_/this.params.pixelRatio),W=Math.round(this.width/this.params.pixelRatio);E.start=E.waveCtx.canvas.offsetLeft/W||0,E.end=E.start+A/W,E.waveCtx.canvas.width=_,E.waveCtx.canvas.height=R,this.style(E.waveCtx.canvas,{width:A+'px'}),this.style(this.progressWave,{display:'block'}),this.hasProgressCanvas&&(E.progressCtx.canvas.width=_,E.progressCtx.canvas.height=R,this.style(E.progressCtx.canvas,{width:A+'px'}))}},{key:'clearWave',value:function(){var E=this;this.canvases.forEach(function(_){return E.clearWaveForEntry(_)})}},{key:'clearWaveForEntry',value:function(E){E.waveCtx.clearRect(0,0,E.waveCtx.canvas.width,E.waveCtx.canvas.height),this.hasProgressCanvas&&E.progressCtx.clearRect(0,0,E.progressCtx.canvas.width,E.progressCtx.canvas.height)}},{key:'drawBars',value:function(E,_,R,A){var W=this;return this.prepareDraw(E,_,R,A,function(S){var T=S.absmax,O=S.hasMinVals,M=S.height,B=S.offsetY,L=S.halfH;if(void 0!==R)for(var Y,D=O?2:1,N=E.length/D,F=W.params.barWidth*W.params.pixelRatio,I=Math.max(W.params.pixelRatio,~~(F/2)),V=N/W.width,X=void 0,X=0;X<A;X+=F+I)Y=Math.round(E[Math.floor(X*V)]/T*L),W.fillRect(X+W.halfPixel,L-Y+B,F+W.halfPixel,2*Y-Y/1.5+3)})}},{key:'drawWave',value:function(E,_,R,A){var W=this;return this.prepareDraw(E,_,R,A,function(S){var T=S.absmax,O=S.hasMinVals,M=S.height,B=S.offsetY,L=S.halfH;if(!O){var F,D=[],N=E.length;for(F=0;F<N;F++)D[2*F]=E[F],D[2*F+1]=-E[F];E=D}void 0!==R&&W.drawLine(E,T,L,B,R,A),W.fillRect(0,L+B-W.halfPixel,W.width,W.halfPixel)})}},{key:'drawLine',value:function(E,_,R,A,W,S){var T=this;this.canvases.forEach(function(O){T.setFillStyles(O),T.drawLineToContext(O,O.waveCtx,E,_,R,A,W,S),T.drawLineToContext(O,O.progressCtx,E,_,R,A,W,S)})}},{key:'drawLineToContext',value:function(E,_,R,A,W,S,T,O){if(_){var M=R.length/2,B=this.params.fillParent&&this.width!=M?this.width/M:1,L=Math.round(M*E.start),D=Math.round(M*E.end)+1;if(!(L>O||D<T)){var I,z,N=Math.min(L,T),F=Math.max(D,O);for(_.beginPath(),_.moveTo((N-L)*B+this.halfPixel,W+S),I=N;I<F;I++){var V=R[2*I]||0,H=Math.round(V/A*W);_.lineTo((I-L)*B+this.halfPixel,W-H+S)}for(z=F-1;z>=N;z--){var q=R[2*z+1]||0,X=Math.round(q/A*W);_.lineTo((z-L)*B+this.halfPixel,W-X+S)}_.closePath(),_.fill()}}}},{key:'fillRect',value:function(E,_,R,A){var T,W=Math.floor(E/this.maxCanvasWidth),S=Math.min(Math.ceil((E+R)/this.maxCanvasWidth)+1,this.canvases.length);for(T=W;T<S;T++){var O=this.canvases[T],M=T*this.maxCanvasWidth,B={x1:Math.max(E,T*this.maxCanvasWidth),y1:_,x2:Math.min(E+R,T*this.maxCanvasWidth+O.waveCtx.canvas.width),y2:_+A};B.x1<B.x2&&(this.setFillStyles(O),this.fillRectToContext(O.waveCtx,B.x1-M,B.y1,B.x2-B.x1,B.y2-B.y1),this.fillRectToContext(O.progressCtx,B.x1-M,B.y1,B.x2-B.x1,B.y2-B.y1))}}},{key:'prepareDraw',value:function(E,_,R,A,W){var S=this;return k.frame(function(){if(E[0]instanceof Array){var T=E;if(S.params.splitChannels)return S.setHeight(T.length*S.params.height*S.params.pixelRatio),void T.forEach(function(I,z){return S.prepareDraw(I,z,R,A,W)});E=T[0]}var O=1/S.params.barHeight;if(S.params.normalize){var M=k.max(E),B=k.min(E);O=-B>M?-B:M}var L=[].some.call(E,function(I){return 0>I}),D=S.params.height*S.params.pixelRatio;return W({absmax:O,hasMinVals:L,height:D,offsetY:D*_||0,halfH:D/2})})()}},{key:'fillRectToContext',value:function(E,_,R,A,W){E&&E.fillRect(_,R,A,W)}},{key:'setFillStyles',value:function(E){E.waveCtx.fillStyle=this.params.waveColor,this.hasProgressCanvas&&(E.progressCtx.fillStyle=this.params.progressColor)}},{key:'getImage',value:function(E,_){var R=this.canvases.map(function(A){return A.wave.toDataURL(E,_)});return 1<R.length?R:R[0]}},{key:'updateProgress',value:function(E){this.style(this.progressWave,{width:E+'px'})}}]),C}(v.default);r.default=g,t.exports=r['default']},function(t,r,n){'use strict';function o(C,w){if(!(C instanceof w))throw new TypeError('Cannot call a class as a function')}function d(C,w){if(!C)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return w&&('object'==typeof w||'function'==typeof w)?w:C}function u(C,w){if('function'!=typeof w&&null!==w)throw new TypeError('Super expression must either be null or a function, not '+typeof w);C.prototype=Object.create(w&&w.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(C,w):C.__proto__=w)}Object.defineProperty(r,'__esModule',{value:!0});var p=function(){function C(w,E){for(var R,_=0;_<E.length;_++)R=E[_],R.enumerable=R.enumerable||!1,R.configurable=!0,'value'in R&&(R.writable=!0),Object.defineProperty(w,R.key,R)}return function(w,E,_){return E&&C(w.prototype,E),_&&C(w,_),w}}(),f=function C(w,E,_){null===w&&(w=Function.prototype);var R=Object.getOwnPropertyDescriptor(w,E);if(R===void 0){var A=Object.getPrototypeOf(w);return null===A?void 0:C(A,E,_)}if('value'in R)return R.value;var W=R.get;return void 0===W?void 0:W.call(_)},v=n(1),m=function(C){return C&&C.__esModule?C:{default:C}}(v),k=n(0),g=function(C){if(C&&C.__esModule)return C;var w={};if(null!=C)for(var E in C)Object.prototype.hasOwnProperty.call(C,E)&&(w[E]=C[E]);return w.default=C,w}(k),P=function(C){function w(E){o(this,w);var _=d(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,E));return _.params=E,_.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){}},_.mediaType=E.mediaType.toLowerCase(),_.elementPosition=E.elementPosition,_.peaks=null,_.playbackRate=1,_.buffer=null,_.onPlayEnd=null,_}return u(w,C),p(w,[{key:'init',value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer()}},{key:'createTimer',value:function(){var _=this;this.on('play',function A(){if(!_.isPaused()){_.fireEvent('audioprocess',_.getCurrentTime());var W=window.requestAnimationFrame||window.webkitRequestAnimationFrame;W(A)}})}},{key:'load',value:function(_,R,A,W){var S=document.createElement(this.mediaType);S.controls=this.params.mediaControls,S.autoplay=this.params.autoplay||!1,S.preload=null==W?'auto':W,S.src=_,S.style.width='100%';var T=R.querySelector(this.mediaType);T&&R.removeChild(T),R.appendChild(S),this._load(S,A)}},{key:'loadElt',value:function(_,R){_.controls=this.params.mediaControls,_.autoplay=this.params.autoplay||!1,this._load(_,R)}},{key:'_load',value:function(_,R){var A=this;'function'==typeof _.load&&_.load(),_.addEventListener('error',function(){A.fireEvent('error','Error loading media element')}),_.addEventListener('canplay',function(){A.fireEvent('canplay')}),_.addEventListener('ended',function(){A.fireEvent('finish')}),_.addEventListener('play',function(){A.fireEvent('play')}),_.addEventListener('pause',function(){A.fireEvent('pause')}),this.media=_,this.peaks=R,this.onPlayEnd=null,this.buffer=null,this.setPlaybackRate(this.playbackRate)}},{key:'isPaused',value:function(){return!this.media||this.media.paused}},{key:'getDuration',value:function(){var _=(this.buffer||this.media).duration;return _>=Infinity&&(_=this.media.seekable.end(0)),_}},{key:'getCurrentTime',value:function(){return this.media&&this.media.currentTime}},{key:'getPlayedPercents',value:function(){return this.getCurrentTime()/this.getDuration()||0}},{key:'getPlaybackRate',value:function(){return this.playbackRate||this.media.playbackRate}},{key:'setPlaybackRate',value:function(_){this.playbackRate=_||1,this.media.playbackRate=this.playbackRate}},{key:'seekTo',value:function(_){null!=_&&(this.media.currentTime=_),this.clearPlayEnd()}},{key:'play',value:function(_,R){this.seekTo(_),this.media.play(),R&&this.setPlayEnd(R)}},{key:'pause',value:function(){this.media&&this.media.pause(),this.clearPlayEnd()}},{key:'setPlayEnd',value:function(_){var R=this;this._onPlayEnd=function(A){A>=_&&(R.pause(),R.seekTo(_))},this.on('audioprocess',this._onPlayEnd)}},{key:'clearPlayEnd',value:function(){this._onPlayEnd&&(this.un('audioprocess',this._onPlayEnd),this._onPlayEnd=null)}},{key:'getPeaks',value:function(_,R,A){return this.buffer?f(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),'getPeaks',this).call(this,_,R,A):this.peaks||[]}},{key:'getVolume',value:function(){return this.media.volume}},{key:'setVolume',value:function(_){this.media.volume=_}},{key:'destroy',value:function(){this.pause(),this.unAll(),this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}]),w}(m.default);r.default=P,t.exports=r['default']},function(t,r){'use strict';function s(d,u){if(!(d instanceof u))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(r,'__esModule',{value:!0});var l=function(){function d(u,p){for(var v,f=0;f<p.length;f++)v=p[f],v.enumerable=v.enumerable||!1,v.configurable=!0,'value'in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}return function(u,p,f){return p&&d(u.prototype,p),f&&d(u,f),u}}(),o=function(){function d(){s(this,d),this.clearPeakCache()}return l(d,[{key:'clearPeakCache',value:function(){this.peakCacheRanges=[],this.peakCacheLength=-1}},{key:'addRangeToPeakCache',value:function(p,f,v){p!=this.peakCacheLength&&(this.clearPeakCache(),this.peakCacheLength=p);for(var m=[],k=0;k<this.peakCacheRanges.length&&this.peakCacheRanges[k]<f;)k++;for(0==k%2&&m.push(f);k<this.peakCacheRanges.length&&this.peakCacheRanges[k]<=v;)m.push(this.peakCacheRanges[k]),k++;0==k%2&&m.push(v),m=m.filter(function(P,C,w){return 0==C?P!=w[C+1]:C==w.length-1?P!=w[C-1]:P!=w[C-1]&&P!=w[C+1]}),this.peakCacheRanges=this.peakCacheRanges.concat(m),this.peakCacheRanges=this.peakCacheRanges.sort(function(P,C){return P-C}).filter(function(P,C,w){return 0==C?P!=w[C+1]:C==w.length-1?P!=w[C-1]:P!=w[C-1]&&P!=w[C+1]});var g=[];for(k=0;k<m.length;k+=2)g.push([m[k],m[k+1]]);return g}},{key:'getCacheRanges',value:function(){var f,p=[];for(f=0;f<this.peakCacheRanges.length;f+=2)p.push([this.peakCacheRanges[f],this.peakCacheRanges[f+1]]);return p}}]),d}();r.default=o,t.exports=r['default']},function(t,r,n){'use strict';function l(m,k){if(!(m instanceof k))throw new TypeError('Cannot call a class as a function')}function o(m,k){if(!m)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return k&&('object'==typeof k||'function'==typeof k)?k:m}function d(m,k){if('function'!=typeof k&&null!==k)throw new TypeError('Super expression must either be null or a function, not '+typeof k);m.prototype=Object.create(k&&k.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(m,k):m.__proto__=k)}Object.defineProperty(r,'__esModule',{value:!0});var u=function(){function m(k,g){for(var C,P=0;P<g.length;P++)C=g[P],C.enumerable=C.enumerable||!1,C.configurable=!0,'value'in C&&(C.writable=!0),Object.defineProperty(k,C.key,C)}return function(k,g,P){return g&&m(k.prototype,g),P&&m(k,P),k}}(),p=n(0),f=function(m){if(m&&m.__esModule)return m;var k={};if(null!=m)for(var g in m)Object.prototype.hasOwnProperty.call(m,g)&&(k[g]=m[g]);return k.default=m,k}(p),v=function(m){function k(g,P){l(this,k);var C=o(this,(k.__proto__||Object.getPrototypeOf(k)).call(this));return C.container=g,C.params=P,C.width=0,C.height=P.height*C.params.pixelRatio,C.lastPos=0,C.wrapper=null,C}return d(k,m),u(k,[{key:'style',value:function(P,C){return f.style(P,C)}},{key:'createWrapper',value:function(){this.wrapper=this.container.appendChild(document.createElement('wave')),this.style(this.wrapper,{display:'block',position:'relative',userSelect:'none',webkitUserSelect:'none',height:this.params.height+'px'}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:'100%',overflowX:this.params.hideScrollbar?'hidden':'auto',overflowY:'hidden'}),this.setupWrapperEvents()}},{key:'handleEvent',value:function(P,C){C||P.preventDefault();var A,w=P.targetTouches?P.targetTouches[0].clientX:P.clientX,E=this.wrapper.getBoundingClientRect(),_=this.width,R=this.getWidth();return!this.params.fillParent&&_<R?(A=(w-E.left)*this.params.pixelRatio/_||0,1<A&&(A=1)):A=(w-E.left+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0,A}},{key:'setupWrapperEvents',value:function(){var P=this;this.wrapper.addEventListener('click',function(C){var w=P.wrapper.offsetHeight-P.wrapper.clientHeight;if(0!=w){var E=P.wrapper.getBoundingClientRect();if(C.clientY>=E.bottom-w)return}P.params.interact&&P.fireEvent('click',C,P.handleEvent(C))}),this.wrapper.addEventListener('scroll',function(C){return P.fireEvent('scroll',C)})}},{key:'drawPeaks',value:function(P,C,w,E){this.setWidth(C)||this.clearWave(),this.params.barWidth?this.drawBars(P,0,w,E):this.drawWave(P,0,w,E)}},{key:'resetScroll',value:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)}},{key:'recenter',value:function(P){var C=this.wrapper.scrollWidth*P;this.recenterOnPosition(C,!0)}},{key:'recenterOnPosition',value:function(P,C){var w=this.wrapper.scrollLeft,E=~~(this.wrapper.clientWidth/2),_=this.wrapper.scrollWidth-this.wrapper.clientWidth,R=P-E,A=R-w;if(0!=_){if(!C&&-E<=A&&A<E){var W=5;A=Math.max(-W,Math.min(W,A)),R=w+A}R=Math.max(0,Math.min(_,R)),R!=w&&(this.wrapper.scrollLeft=R)}}},{key:'getScrollX',value:function(){return Math.round(this.wrapper.scrollLeft*this.params.pixelRatio)}},{key:'getWidth',value:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)}},{key:'setWidth',value:function(P){return this.width!=P&&(this.width=P,this.params.fillParent||this.params.scrollParent?this.style(this.wrapper,{width:''}):this.style(this.wrapper,{width:~~(this.width/this.params.pixelRatio)+'px'}),this.updateSize(),!0)}},{key:'setHeight',value:function(P){return P!=this.height&&(this.height=P,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+'px'}),this.updateSize(),!0)}},{key:'progress',value:function(P){var C=1/this.params.pixelRatio,w=Math.round(P*this.width)*C;if(w<this.lastPos||w-this.lastPos>=C){if(this.lastPos=w,this.params.scrollParent&&this.params.autoCenter){var E=~~(this.wrapper.scrollWidth*P);this.recenterOnPosition(E)}this.updateProgress(w)}}},{key:'destroy',value:function(){this.unAll(),this.wrapper&&(this.wrapper.parentNode==this.container&&this.container.removeChild(this.wrapper),this.wrapper=null)}},{key:'updateSize',value:function(){}},{key:'drawBars',value:function(){}},{key:'drawWave',value:function(){}},{key:'clearWave',value:function(){}},{key:'updateProgress',value:function(){}}]),k}(f.Observer);r.default=v,t.exports=r['default']},function(t,r,n){'use strict';Object.defineProperty(r,'__esModule',{value:!0}),r.default=function(u){var p=new d.default,f=new XMLHttpRequest,v=!1;return f.open(u.method||'GET',u.url,!0),f.responseType=u.responseType||'json',f.addEventListener('progress',function(m){p.fireEvent('progress',m),m.lengthComputable&&m.loaded==m.total&&(v=!0)}),f.addEventListener('load',function(m){v||p.fireEvent('progress',m),p.fireEvent('load',m),200==f.status||206==f.status?p.fireEvent('success',f.response,m):p.fireEvent('error',m)}),f.addEventListener('error',function(m){return p.fireEvent('error',m)}),f.send(),p.xhr=f,p};var o=n(2),d=function(u){return u&&u.__esModule?u:{default:u}}(o);t.exports=r['default']},function(t,r){'use strict';Object.defineProperty(r,'__esModule',{value:!0}),r.default=function(l){for(var o=arguments.length,d=Array(1<o?o-1:0),u=1;u<o;u++)d[u-1]=arguments[u];return d.forEach(function(p){Object.keys(p).forEach(function(f){l[f]=p[f]})}),l},t.exports=r['default']},function(t,r,n){'use strict';Object.defineProperty(r,'__esModule',{value:!0}),r.default=function(u){return function(){for(var p=arguments.length,f=Array(p),v=0;v<p;v++)f[v]=arguments[v];return(0,d.default)(function(){return u.apply(void 0,f)})}};var o=n(3),d=function(u){return u&&u.__esModule?u:{default:u}}(o);t.exports=r['default']},function(t,r){'use strict';Object.defineProperty(r,'__esModule',{value:!0}),r.default=function(){return'wavesurfer_'+Math.random().toString(32).substring(2)},t.exports=r['default']},function(t,r){'use strict';Object.defineProperty(r,'__esModule',{value:!0}),r.default=function(l){var o=-Infinity;return Object.keys(l).forEach(function(d){l[d]>o&&(o=l[d])}),o},t.exports=r['default']},function(t,r){'use strict';Object.defineProperty(r,'__esModule',{value:!0}),r.default=function(l){var o=+Infinity;return Object.keys(l).forEach(function(d){l[d]<o&&(o=l[d])}),o},t.exports=r['default']},function(t,r){'use strict';Object.defineProperty(r,'__esModule',{value:!0}),r.default=function(l,o){return Object.keys(o).forEach(function(d){l.style[d]!==o[d]&&(l.style[d]=o[d])}),l},t.exports=r['default']},function(t,r,n){'use strict';function s(W){return W&&W.__esModule?W:{default:W}}function o(W,S){if(!W)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return S&&('object'==typeof S||'function'==typeof S)?S:W}function d(W,S){if('function'!=typeof S&&null!==S)throw new TypeError('Super expression must either be null or a function, not '+typeof S);W.prototype=Object.create(S&&S.prototype,{constructor:{value:W,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(W,S):W.__proto__=S)}function u(W,S){if(!(W instanceof S))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(r,'__esModule',{value:!0});var p=function(){function W(S,T){for(var M,O=0;O<T.length;O++)M=T[O],M.enumerable=M.enumerable||!1,M.configurable=!0,'value'in M&&(M.writable=!0),Object.defineProperty(S,M.key,M)}return function(S,T,O){return T&&W(S.prototype,T),O&&W(S,O),S}}(),f=n(0),v=function(W){if(W&&W.__esModule)return W;var S={};if(null!=W)for(var T in W)Object.prototype.hasOwnProperty.call(W,T)&&(S[T]=W[T]);return S.default=W,S}(f),m=n(4),k=s(m),g=n(1),P=s(g),C=n(5),w=s(C),E=n(6),_=s(E),R=function(){function W(){u(this,W)}return p(W,[{key:'create',value:function(){}}]),p(W,[{key:'init',value:function(){}},{key:'destroy',value:function(){}}]),W}(),A=function(W){function S(T){var O;u(this,S);var M=o(this,(S.__proto__||Object.getPrototypeOf(S)).call(this));if(M.defaultParams={audioContext:null,audioRate:1,autoCenter:!0,backend:'WebAudio',barHeight:1,container:null,cursorColor:'#333',cursorWidth:1,dragSelection:!0,fillParent:!0,forceDecode:!1,height:128,hideScrollbar:!1,interact:!0,loopSelection:!0,maxCanvasWidth:4e3,mediaContainer:null,mediaControls:!1,mediaType:'audio',minPxPerSec:20,normalize:!1,partialRender:!1,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,plugins:[],progressColor:'#555',renderer:k.default,responsive:!1,scrollParent:!1,skipLength:2,splitChannels:!1,waveColor:'#999'},M.backends={MediaElement:w.default,WebAudio:P.default},M.util=v,M.params=v.extend({},M.defaultParams,T),M.container='string'==typeof T.container?document.querySelector(M.params.container):M.params.container,!M.container)throw new Error('Container element not found');if(M.mediaContainer=null==M.params.mediaContainer?M.container:'string'==typeof M.params.mediaContainer?document.querySelector(M.params.mediaContainer):M.params.mediaContainer,!M.mediaContainer)throw new Error('Media Container element not found');if(1>=M.params.maxCanvasWidth)throw new Error('maxCanvasWidth must be greater than 1');else if(1==M.params.maxCanvasWidth%2)throw new Error('maxCanvasWidth must be an even number');if(M.savedVolume=0,M.isMuted=!1,M.tmpEvents=[],M.currentAjax=null,M.arraybuffer=null,M.drawer=null,M.backend=null,M.peakCache=null,'function'!=typeof M.params.renderer)throw new Error('Renderer parameter is invalid');M.Drawer=M.params.renderer,M.Backend=M.backends[M.params.backend],M.initialisedPluginList={},M.isDestroyed=!1,M.isReady=!1;var B=0;return M._onResize=v.debounce(function(){B!=M.drawer.wrapper.clientWidth&&(B=M.drawer.wrapper.clientWidth,M.drawBuffer())},'number'==typeof M.params.responsive?M.params.responsive:100),O=M,o(M,O)}return d(S,W),p(S,null,[{key:'create',value:function(O){var M=new S(O);return M.init()}}]),p(S,[{key:'init',value:function(){return this.registerPlugins(this.params.plugins),this.createDrawer(),this.createBackend(),this.createPeakCache(),this}},{key:'registerPlugins',value:function(O){var M=this;return O.forEach(function(B){return M.addPlugin(B)}),O.forEach(function(B){B.deferInit||M.initPlugin(B.name)}),this.fireEvent('plugins-registered',O),this}},{key:'addPlugin',value:function(O){var M=this;if(!O.name)throw new Error('Plugin does not have a name!');if(!O.instance)throw new Error('Plugin '+O.name+' does not have an instance property!');O.staticProps&&Object.keys(O.staticProps).forEach(function(D){M[D]=O.staticProps[D]});var B=O.instance,L=Object.getOwnPropertyNames(v.Observer.prototype);return L.forEach(function(D){B.prototype[D]=v.Observer.prototype[D]}),this[O.name]=new B(O.params||{},this),this.fireEvent('plugin-added',O.name),this}},{key:'initPlugin',value:function(O){if(!this[O])throw new Error('Plugin '+O+' has not been added yet!');return this.initialisedPluginList[O]&&this.destroyPlugin(O),this[O].init(),this.initialisedPluginList[O]=!0,this.fireEvent('plugin-initialised',O),this}},{key:'destroyPlugin',value:function(O){if(!this[O])throw new Error('Plugin '+O+' has not been added yet and cannot be destroyed!');if(!this.initialisedPluginList[O])throw new Error('Plugin '+O+' is not active and cannot be destroyed!');if('function'!=typeof this[O].destroy)throw new Error('Plugin '+O+' does not have a destroy function!');return this[O].destroy(),delete this.initialisedPluginList[O],this.fireEvent('plugin-destroyed',O),this}},{key:'destroyAllPlugins',value:function(){var O=this;Object.keys(this.initialisedPluginList).forEach(function(M){return O.destroyPlugin(M)})}},{key:'createDrawer',value:function(){var O=this;this.drawer=new this.Drawer(this.container,this.params),this.drawer.init(),this.fireEvent('drawer-created',this.drawer),this.params.responsive&&window.addEventListener('resize',this._onResize,!0),this.drawer.on('redraw',function(){O.drawBuffer(),O.drawer.progress(O.backend.getPlayedPercents())}),this.drawer.on('click',function(M,B){setTimeout(function(){return O.seekTo(B)},0)}),this.drawer.on('scroll',function(M){O.params.partialRender&&O.drawBuffer(),O.fireEvent('scroll',M)})}},{key:'createBackend',value:function(){var O=this;this.backend&&this.backend.destroy(),'AudioElement'==this.params.backend&&(this.params.backend='MediaElement'),'WebAudio'!=this.params.backend||this.Backend.prototype.supportsWebAudio.call(null)||(this.params.backend='MediaElement'),this.backend=new this.Backend(this.params),this.backend.init(),this.fireEvent('backend-created',this.backend),this.backend.on('finish',function(){return O.fireEvent('finish')}),this.backend.on('play',function(){return O.fireEvent('play')}),this.backend.on('pause',function(){return O.fireEvent('pause')}),this.backend.on('audioprocess',function(M){O.drawer.progress(O.backend.getPlayedPercents()),O.fireEvent('audioprocess',M)})}},{key:'createPeakCache',value:function(){this.params.partialRender&&(this.peakCache=new _.default)}},{key:'getDuration',value:function(){return this.backend.getDuration()}},{key:'getCurrentTime',value:function(){return this.backend.getCurrentTime()}},{key:'setCurrentTime',value:function(O){this.getDuration()>=O?this.seekTo(1):this.seekTo(O/this.getDuration())}},{key:'play',value:function(O,M){var B=this;this.fireEvent('interaction',function(){return B.play(O,M)}),this.backend.play(O,M)}},{key:'pause',value:function(){this.backend.isPaused()||this.backend.pause()}},{key:'playPause',value:function(){this.backend.isPaused()?this.play():this.pause()}},{key:'isPlaying',value:function(){return!this.backend.isPaused()}},{key:'skipBackward',value:function(O){this.skip(-O||-this.params.skipLength)}},{key:'skipForward',value:function(O){this.skip(O||this.params.skipLength)}},{key:'skip',value:function(O){var M=this.getDuration()||1,B=this.getCurrentTime()||0;B=Math.max(0,Math.min(M,B+(O||0))),this.seekAndCenter(B/M)}},{key:'seekAndCenter',value:function(O){this.seekTo(O),this.drawer.recenter(O)}},{key:'seekTo',value:function(O){var M=this;this.fireEvent('interaction',function(){return M.seekTo(O)});var B=this.backend.isPaused();B||this.backend.pause();var L=this.params.scrollParent;this.params.scrollParent=!1,this.backend.seekTo(O*this.getDuration()),this.drawer.progress(this.backend.getPlayedPercents()),B||this.backend.play(),this.params.scrollParent=L,this.fireEvent('seek',O)}},{key:'stop',value:function(){this.pause(),this.seekTo(0),this.drawer.progress(0)}},{key:'setVolume',value:function(O){this.backend.setVolume(O)}},{key:'getVolume',value:function(){return this.backend.getVolume()}},{key:'setPlaybackRate',value:function(O){this.backend.setPlaybackRate(O)}},{key:'getPlaybackRate',value:function(){return this.backend.getPlaybackRate()}},{key:'toggleMute',value:function(){this.setMute(!this.isMuted)}},{key:'setMute',value:function(O){O===this.isMuted||(O?(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0):(this.backend.setVolume(this.savedVolume),this.isMuted=!1))}},{key:'getMute',value:function(){return this.isMuted}},{key:'getFilters',value:function(){return this.backend.filters||[]}},{key:'toggleScroll',value:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()}},{key:'toggleInteraction',value:function(){this.params.interact=!this.params.interact}},{key:'drawBuffer',value:function(){var O=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),M=this.drawer.getWidth(),B=O,L=this.drawer.getScrollX(),D=Math.max(L+M,B);this.params.fillParent&&(!this.params.scrollParent||O<M)&&(B=M,L=0,D=B);var N;if(this.params.partialRender){var I,F=this.peakCache.addRangeToPeakCache(B,L,D);for(I=0;I<F.length;I++)N=this.backend.getPeaks(B,F[I][0],F[I][1]),this.drawer.drawPeaks(N,B,F[I][0],F[I][1])}else N=this.backend.getPeaks(B,L,D),this.drawer.drawPeaks(N,B,L,D);this.fireEvent('redraw',N,B)}},{key:'zoom',value:function(O){O?(this.params.minPxPerSec=O,this.params.scrollParent=!0):(this.params.minPxPerSec=this.defaultParams.minPxPerSec,this.params.scrollParent=!1),this.drawBuffer(),this.drawer.progress(this.backend.getPlayedPercents()),this.drawer.recenter(this.getCurrentTime()/this.getDuration()),this.fireEvent('zoom',O)}},{key:'loadArrayBuffer',value:function(O){var M=this;this.decodeArrayBuffer(O,function(B){M.isDestroyed||M.loadDecodedBuffer(B)})}},{key:'loadDecodedBuffer',value:function(O){this.backend.load(O),this.drawBuffer(),this.fireEvent('ready'),this.isReady=!0}},{key:'loadBlob',value:function(O){var M=this,B=new FileReader;B.addEventListener('progress',function(L){return M.onProgress(L)}),B.addEventListener('load',function(L){return M.loadArrayBuffer(L.target.result)}),B.addEventListener('error',function(){return M.fireEvent('error','Error reading file')}),B.readAsArrayBuffer(O),this.empty()}},{key:'load',value:function(O,M,B){switch(this.empty(),this.isMuted=!1,this.params.backend){case'WebAudio':return this.loadBuffer(O,M);case'MediaElement':return this.loadMediaElement(O,M,B);}}},{key:'loadBuffer',value:function(O,M){var B=this,L=function(N){return N&&B.tmpEvents.push(B.once('ready',N)),B.getArrayBuffer(O,function(F){return B.loadArrayBuffer(F)})};return M?void(this.backend.setPeaks(M),this.drawBuffer(),this.tmpEvents.push(this.once('interaction',L))):L()}},{key:'loadMediaElement',value:function(O,M,B){var L=this,D=O;if('string'==typeof O)this.backend.load(D,this.mediaContainer,M,B);else{var N=O;this.backend.loadElt(N,M),D=N.src}this.tmpEvents.push(this.backend.once('canplay',function(){L.drawBuffer(),L.fireEvent('ready'),L.isReady=!0}),this.backend.once('error',function(F){return L.fireEvent('error',F)})),M&&this.backend.setPeaks(M),(!M||this.params.forceDecode)&&this.backend.supportsWebAudio()&&this.getArrayBuffer(D,function(F){L.decodeArrayBuffer(F,function(I){L.backend.buffer=I,L.backend.setPeaks(null),L.drawBuffer(),L.fireEvent('waveform-ready')})})}},{key:'decodeArrayBuffer',value:function(O,M){var B=this;this.arraybuffer=O,this.backend.decodeArrayBuffer(O,function(L){B.isDestroyed||B.arraybuffer!=O||(M(L),B.arraybuffer=null)},function(){return B.fireEvent('error','Error decoding audiobuffer')})}},{key:'getArrayBuffer',value:function(O,M){var B=this,L=v.ajax({url:O,responseType:'arraybuffer'});return this.currentAjax=L,this.tmpEvents.push(L.on('progress',function(D){B.onProgress(D)}),L.on('success',function(D){M(D),B.currentAjax=null}),L.on('error',function(D){B.fireEvent('error','XHR error: '+D.target.statusText),B.currentAjax=null})),L}},{key:'onProgress',value:function(O){var M;M=O.lengthComputable?O.loaded/O.total:O.loaded/(O.loaded+1e6),this.fireEvent('loading',Math.round(100*M),O.target)}},{key:'exportPCM',value:function(O,M,B,L){O=O||1024,L=L||0,M=M||1e4,B=B||!1;var D=this.backend.getPeaks(O,L),N=[].map.call(D,function(I){return Math.round(I*M)/M}),F=JSON.stringify(N);return B||window.open('data:application/json;charset=utf-8,'+encodeURIComponent(F)),F}},{key:'exportImage',value:function(O,M){return O||(O='image/png'),M||(M=1),this.drawer.getImage(O,M)}},{key:'cancelAjax',value:function(){this.currentAjax&&(this.currentAjax.xhr.abort(),this.currentAjax=null)}},{key:'clearTmpEvents',value:function(){this.tmpEvents.forEach(function(O){return O.un()})}},{key:'empty',value:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.cancelAjax(),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)}},{key:'destroy',value:function(){this.destroyAllPlugins(),this.fireEvent('destroy'),this.cancelAjax(),this.clearTmpEvents(),this.unAll(),this.params.responsive&&window.removeEventListener('resize',this._onResize,!0),this.backend.destroy(),this.drawer.destroy(),this.isDestroyed=!0,this.arraybuffer=null}}]),S}(v.Observer);A.util=v,r.default=A,t.exports=r['default']},function(t){t.exports=function(s,l,o){function d(){var g=Date.now()-v;g<l&&0<=g?u=setTimeout(d,l-g):(u=null,!o&&(m=s.apply(f,p),f=p=null))}var u,p,f,v,m;null==l&&(l=100);var k=function(){f=this,p=arguments,v=Date.now();var g=o&&!u;return u||(u=setTimeout(d,l)),g&&(m=s.apply(f,p),f=p=null),m};return k.clear=function(){u&&(clearTimeout(u),u=null)},k}}])});